graph TB
    %% User Layer
    subgraph "ğŸ‘¤ Users"
        User[ğŸ‘¤ End User<br/>iOS/Android/Web]
    end

    %% Client Applications Layer
    subgraph "ğŸ“± Client Applications"
        subgraph "Expo App<br/>(React Native)"
            ExpoApp[ğŸ“± Expo App<br/>iOS/Android]
            ExpoRouter[ğŸ—ï¸ Expo Router<br/>File-based Routing]
            VisionCam[ğŸ“· Vision Camera<br/>Native Camera]
        end

        subgraph "Next.js App<br/>(Web)"
            NextApp[ğŸŒ Next.js App<br/>SSR/SSG]
            NextRouter[ğŸ—ï¸ Next.js Router<br/>App Router]
            MediaPipe[ğŸ¤– MediaPipe<br/>Web Pose Detection]
        end
    end

    %% Shared Packages Layer
    subgraph "ğŸ“¦ Shared Packages"
        subgraph "@my/ui<br/>UI Components"
            Tamagui[ğŸ¨ Tamagui<br/>Cross-platform UI]
            Components[ğŸ§© Components<br/>Buttons, Forms, Layouts]
            Theme[ğŸ­ Theme System<br/>Design Tokens]
        end

        subgraph "@my/app<br/>Business Logic"
            Features[âš¡ Features<br/>CameraRecording, Auth]
            Hooks[ğŸª Custom Hooks<br/>useCamera, usePose]
            Stores[ğŸª Zustand Stores<br/>State Management]
            Validation[âœ… Validation<br/>Zod Schemas]
        end

        subgraph "@my/api<br/>Backend Client"
            SupabaseClient[ğŸ”— Supabase Client<br/>Typed API Client]
            TanStackQuery[ğŸ”„ TanStack Query<br/>Data Fetching]
            Realtime[ğŸ“¡ Realtime Subscriptions<br/>Live Updates]
        end
    end

    %% Backend Layer
    subgraph "â˜ï¸ Supabase Backend"
        subgraph "Database Layer"
            PostgreSQL[(ğŸ—„ï¸ PostgreSQL<br/>Primary Database)]
            RLS[ğŸ” Row Level Security<br/>Data Access Control]
            RealtimeDB[ğŸ“¡ Realtime<br/>Live Queries]
        end

        subgraph "Storage Layer"
            SupabaseStorage[ğŸ“ File Storage<br/>Videos, Audio, Assets]
            CDN[ğŸŒ CDN<br/>Global Delivery]
        end

        subgraph "Edge Functions"
            AIFunctions[ğŸ¤– AI Functions<br/>Video Analysis Pipeline]
            AuthFunctions[ğŸ” Auth Functions<br/>Custom Auth Logic]
            ProcessingFunctions[âš™ï¸ Processing Functions<br/>Media Processing]
        end

        subgraph "Auth Layer"
            SupabaseAuth[ğŸ”‘ Supabase Auth<br/>JWT Authentication]
            UserManagement[ğŸ‘¥ User Management<br/>Profiles & Sessions]
        end
    end

    %% AI Services Layer
    subgraph "ğŸ§  AI Services"
        subgraph "Pose Detection"
            TensorFlow[ğŸ¤– TensorFlow.js<br/>Web Processing]
            VisionCameraAI[ğŸ“· Vision Camera<br/>Native Processing]
            MediaPipeWeb[ğŸ¯ MediaPipe<br/>Web Implementation]
        end

        subgraph "Voice Analysis"
            WebAudioAPI[ğŸ¤ Web Audio API<br/>Web Recording]
            ExpoAV[ğŸµ Expo AV<br/>Native Audio]
            VoiceProcessing[ğŸ™ï¸ Voice Processing<br/>Edge Functions]
        end

        subgraph "AI Feedback"
            LLMService[ğŸ’­ LLM Service<br/>Text Generation]
            TTSService[ğŸ”Š Text-to-Speech<br/>Audio Generation]
            FeedbackEngine[ğŸ’¬ Feedback Engine<br/>Structured Analysis]
        end
    end

    %% Development & Build Tools
    subgraph "ğŸ› ï¸ Development Tools"
        subgraph "Build System"
            Turbo[âš¡ Turbo<br/>Build Orchestration]
            Yarn4[ğŸ§¶ Yarn 4<br/>Workspace Management]
            TypeScript[ğŸ“ TypeScript<br/>Type Safety]
        end

        subgraph "Quality Gates"
            Biome[âœ¨ Biome<br/>Linting/Formatting]
            Vitest[ğŸ§ª Vitest<br/>Unit Testing]
            Playwright[ğŸ­ Playwright<br/>E2E Testing]
        end

        subgraph "CI/CD"
            GitHubActions[âš™ï¸ GitHub Actions<br/>CI Pipeline]
            EAS[ğŸ“¦ Expo Application Services<br/>Native Builds]
            Vercel[â–² Vercel<br/>Web Deployment]
        end
    end

    %% Data Flow Connections
    User --> ExpoApp
    User --> NextApp

    ExpoApp --> ExpoRouter
    NextApp --> NextRouter

    ExpoApp --> VisionCam
    NextApp --> MediaPipe

    ExpoApp --> Tamagui
    NextApp --> Tamagui

    Tamagui --> Components
    Tamagui --> Theme

    ExpoApp --> Features
    NextApp --> Features

    Features --> Hooks
    Features --> Stores
    Features --> Validation

    Features --> SupabaseClient
    Hooks --> SupabaseClient
    Stores --> SupabaseClient

    SupabaseClient --> TanStackQuery
    SupabaseClient --> Realtime

    TanStackQuery --> PostgreSQL
    Realtime --> RealtimeDB

    SupabaseClient --> SupabaseStorage
    SupabaseStorage --> CDN

    Features --> AIFunctions
    AIFunctions --> PoseDetection
    AIFunctions --> VoiceProcessing
    AIFunctions --> FeedbackEngine

    PoseDetection --> TensorFlow
    PoseDetection --> VisionCameraAI
    PoseDetection --> MediaPipeWeb

    VoiceProcessing --> WebAudioAPI
    VoiceProcessing --> ExpoAV

    FeedbackEngine --> LLMService
    FeedbackEngine --> TTSService

    AIFunctions --> PostgreSQL
    AIFunctions --> SupabaseStorage

    SupabaseAuth --> UserManagement
    SupabaseAuth --> PostgreSQL

    Features --> SupabaseAuth

    %% Development Flow
    Turbo --> ExpoApp
    Turbo --> NextApp
    Turbo --> Tamagui
    Turbo --> Features
    Turbo --> SupabaseClient

    Yarn4 --> Turbo
    Yarn4 --> Biome
    Yarn4 --> Vitest
    Yarn4 --> Playwright

    GitHubActions --> Yarn4
    EAS --> ExpoApp
    Vercel --> NextApp

    TypeScript --> ExpoApp
    TypeScript --> NextApp
    TypeScript --> Tamagui
    TypeScript --> Features
    TypeScript --> SupabaseClient

    %% Styling
    classDef userLayer fill:#e3f2fd,stroke:#1976d2,stroke-width:3px
    classDef clientLayer fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef sharedLayer fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef backendLayer fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef aiLayer fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef devLayer fill:#e0f2f1,stroke:#00695c,stroke-width:2px

    class User userLayer
    class ExpoApp,NextApp,ExpoRouter,NextRouter,VisionCam,MediaPipe clientLayer
    class Tamagui,Components,Theme,Features,Hooks,Stores,Validation,SupabaseClient,TanStackQuery,Realtime sharedLayer
    class PostgreSQL,RLS,RealtimeDB,SupabaseStorage,CDN,AIFunctions,AuthFunctions,ProcessingFunctions,SupabaseAuth,UserManagement backendLayer
    class TensorFlow,VisionCameraAI,MediaPipeWeb,WebAudioAPI,ExpoAV,VoiceProcessing,LLMService,TTSService,FeedbackEngine aiLayer
    class Turbo,Yarn4,TypeScript,Biome,Vitest,Playwright,GitHubActions,EAS,Vercel devLayer

    %% Legend
    subgraph "ğŸ“Š Legend"
        direction LR
        UserLegend[ğŸ‘¤ User Layer]:::userLayer
        ClientLegend[ğŸ“± Client Apps]:::clientLayer
        SharedLegend[ğŸ“¦ Shared Code]:::sharedLayer
        BackendLegend[â˜ï¸ Backend]:::backendLayer
        AILegend[ğŸ§  AI Services]:::aiLayer
        DevLegend[ğŸ› ï¸ Dev Tools]:::devLayer
    end
