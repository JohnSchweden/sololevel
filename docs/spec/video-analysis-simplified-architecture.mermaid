graph TB
    subgraph Props["üì• Props"]
        ScreenProps["VideoAnalysisScreenProps<br/>analysisJobId<br/>videoUri<br/>onBack"]
    end

    subgraph CoreHooks["üéØ Core Hooks (3-4 Total)"]
        VideoPlayer["useVideoPlayer<br/>Consolidates:<br/>- useVideoPlayback<br/>- useVideoControls<br/>- useVideoAudioSync<br/>Returns: imperative ref API"]
        FeedbackSystem["useFeedbackSystem<br/>Consolidates:<br/>- useFeedbackCoordinator<br/>- useFeedbackAudioSource<br/>- useAudioController<br/>- useFeedbackPanel<br/>Returns: feedback state + handlers"]
        Analysis["useAnalysis<br/>Consolidates:<br/>- useAnalysisState<br/>- useHistoricalAnalysis<br/>Returns: analysis phase + data"]
    end

    subgraph NativeOnly["üì± Native-Only Hook"]
        VideoLayout["useVideoLayout<br/>Consolidates:<br/>- useGestureController<br/>- useAnimationController<br/>Returns: gesture + animation refs"]
    end

    subgraph Store["üóÉÔ∏è Single Zustand Store"]
        FeedbackStore["useFeedbackStore<br/>Single source of truth:<br/>- highlightedFeedbackId<br/>- bubbleState<br/>- overlayVisible<br/>- activeAudio<br/>- panelState"]
    end

    subgraph Components["üì¶ Components"]
        VideoPlayerComp["VideoPlayer<br/>(imperative ref API)"]
        FeedbackPanelComp["FeedbackPanel<br/>(reads from store)"]
    end

    %% Props flow
    ScreenProps --> VideoPlayer
    ScreenProps --> FeedbackSystem
    ScreenProps --> Analysis

    %% Hook dependencies
    Analysis --> FeedbackSystem
    VideoPlayer --> FeedbackSystem

    %% Store integration
    FeedbackSystem --> FeedbackStore

    %% Native-only
    VideoLayout -.-> VideoPlayer
    VideoLayout -.-> FeedbackSystem

    %% Component rendering
    VideoPlayer --> VideoPlayerComp
    FeedbackSystem --> FeedbackPanelComp
    FeedbackStore --> FeedbackPanelComp

    %% Styling
    classDef core fill:#e3f2fd,stroke:#1976d2,stroke-width:3px
    classDef native fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    classDef store fill:#fce4ec,stroke:#ad1457,stroke-width:3px
    classDef component fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    classDef props fill:#f5f5f5,stroke:#616161,stroke-width:2px

    class VideoPlayer,FeedbackSystem,Analysis core
    class VideoLayout native
    class FeedbackStore store
    class VideoPlayerComp,FeedbackPanelComp component
    class ScreenProps props

