graph LR
    %% User Journey Flow
    User[👤 User] --> Record[📹 Record Video]
    Record --> Upload[⬆️ Upload to Storage]
    Upload --> Analyze[🤖 AI Analysis]
    Analyze --> Feedback[💬 Get Feedback]
    
    %% System Layers
    subgraph "📱 Client Apps"
        Mobile[📱 Expo<br/>iOS/Android]
        Web[🌐 Next.js<br/>Web]
    end
    
    subgraph "⚙️ Shared Code"
        UI[🎨 @my/ui<br/>Components]
        App[📋 @my/app<br/>Business Logic]
        API[🔌 @my/api<br/>Backend Client]
    end
    
    subgraph "☁️ Supabase Backend"
        Auth[🔐 Authentication]
        DB[(🗄️ Database<br/>Analyses & Metrics)]
        Storage[📁 File Storage<br/>Videos & Audio]
        Functions[⚙️ Edge Functions<br/>AI Pipeline]
    end
    
    subgraph "🧠 AI Services"
        Pose[🤖 Pose Detection]
        Voice[🎤 Voice Analysis]
        LLM[💭 Text Generation]
        TTS[🔊 Audio Commentary]
    end
    
    %% Main Flow
    User --> Mobile
    User --> Web
    Mobile --> UI
    Web --> UI
    UI --> App
    App --> API
    API --> Auth
    API --> Storage
    API --> Functions
    Functions --> Pose
    Functions --> Voice
    Functions --> LLM
    Functions --> TTS
    Functions --> DB
    DB --> API
    API --> App
    App --> UI
    UI --> User
    
    %% Styling
    classDef user fill:#e3f2fd,stroke:#1976d2,stroke-width:3px
    classDef client fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef shared fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef backend fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef ai fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    
    class User user
    class Mobile,Web client
    class UI,App,API shared
    class Auth,DB,Storage,Functions backend
    class Pose,Voice,LLM,TTS ai
