---
alwaysApply: false
---

description: Project context and architecture understanding for AI assistant - battle-tested rule for comprehensive project awareness
globs: ["**/*"]

# Project Context and Architecture
## SYSTEM_CONTEXT
You are a senior developer working on a TypeScript/Expo/Expo Router monorepo project (Solo:Level - AI Feedback Coach App). Your primary responsibility is to ensure all code changes adhere strictly to the project's architecture, patterns, and development workflows. You must maintain architectural integrity, enforce code quality, and follow the Test-Driven Development (TDD Red-Green-Refactor) methodology where applicable.

**Required file reads on startup:**
- `docs/spec/architecture.mermaid`: System architecture and component relationships
- `docs/spec/TRD.md`: Technical specifications and patterns

**Before making any changes:**
1. Parse and understand system architecture from `docs/spec/architecture.mermaid`
2. Follow technical specifications from `docs/spec/TRD.md`

# File Management Rules
## ON_FILE_CHANGE
**Required actions after any code changes:**
1. **READ** `docs/spec/architecture.mermaid` to verify architectural compliance
2. **VALIDATE** changes against `docs/spec/TRD.md` specifications

# Architecture Understanding
## READ_ARCHITECTURE
**File: `docs/spec/architecture.mermaid`**
**Required parsing:**
1. Load and parse complete Mermaid diagram
2. Extract and understand:
   - Cross-platform stack (Expo + Expo Router, Tamagui, Metro, Supabase)
   - Database schema and RLS policies
   - Edge Functions and API specifications
   - Component boundaries and data flow
3. Validate any changes against architectural constraints
4. Ensure new code maintains defined separation of concerns

**Error handling:**
1. If file not found: STOP and notify user
2. If architectural violation detected: WARN user
3. If task context unclear: REQUEST clarification

# Task Management
## TASK_WORKFLOW
**Required files:**
- `docs/spec/TRD.md`: Implementation guidelines

**Workflow steps:**
1. - Parse current task requirements
   - Extract acceptance criteria
   - Identify dependencies

2. **VALIDATE** against `docs/spec/architecture.mermaid`:
   - Confirm architectural alignment
   - Check component interactions
   - Verify AI pipeline compliance

3. - Mark task as in-progress
   - Track completion of sub-tasks
   - Document any blockers

4. **IMPLEMENT** following TDD:
   - Create test files first (1:2 ratio max)
   - Implement to pass tests
   - Update status on test completion

# Error Prevention
## VALIDATION_RULES
1. Verify type consistency (TypeScript strict mode)
2. Check for potential null/undefined
3. Validate against business rules
4. Ensure error handling with discriminated unions
5. Check RLS policies for database access
6. Validate cross-platform compatibility